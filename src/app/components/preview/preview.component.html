<ion-card>
  <ion-card-header>
    <ion-card-title>
      Search Preview
      <ion-badge [color]="booleanLevelColor" class="boolean-level-badge">
        {{ booleanLevelLabel }}
      </ion-badge>
      @if (operatorCount > 0) {
        <ion-badge [color]="badgeColor" class="operator-badge">
          {{ operatorCount }} operators
        </ion-badge>
      }
    </ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <!-- Quality Score Badge -->
    @if (qualityScore) {
      <div class="quality-score">
        <ion-badge [color]="scoreColor" class="score-badge">
          {{ qualityScore.score }} - {{ scoreLabel }}
        </ion-badge>

        @if (qualityScore.reasons.length > 0) {
          <div class="quality-reasons">
            @for (reason of qualityScore.reasons; track reason.message) {
              <div class="reason" [class.warning]="reason.type === 'warning'">
                <ion-icon [name]="reason.type === 'warning' ? 'alert-circle-outline' : 'information-circle-outline'"
                          [color]="reason.type === 'warning' ? 'warning' : 'medium'">
                </ion-icon>
                <span>{{ reason.message }}</span>
              </div>
            }
          </div>
        }
      </div>
    }

    <!-- Emotional Mode Badge (when not normal) -->
    @if (showEmotionalModeBadge) {
      <div class="emotional-mode-badge">
        <ion-badge [color]="emotionalModeColor">
          {{ emotionalModeConfig[emotionalMode].icon }} {{ emotionalModeConfig[emotionalMode].label }} Mode
        </ion-badge>
        <ion-text color="medium" class="mode-description">
          <small>{{ emotionalModeConfig[emotionalMode].description }}</small>
        </ion-text>
      </div>
    }
    <!-- Warnings -->
    @if (warnings.length > 0) {
      <ion-list class="warnings-list" lines="none">
        @for (warn of warnings; track warn) {
          <ion-item [color]="getWarningColor(warn)">
            <ion-icon name="warning" slot="start"></ion-icon>
            <ion-label class="ion-text-wrap">{{ warn }}</ion-label>
          </ion-item>
        }
      </ion-list>
    }

    <!-- Boolean Query Section -->
    <div class="preview-section">
      <ion-text color="medium">
        <h4>Boolean Query</h4>
      </ion-text>
      <pre class="query-display" [class.empty]="!booleanQuery">{{ booleanQuery || 'Enter search criteria above to generate query' }}</pre>
    </div>

    <!-- URL Section -->
    <div class="preview-section">
      <ion-text color="medium">
        <h4>{{ platformLabel }} URL</h4>
      </ion-text>
      <pre class="url-display" [class.empty]="!searchUrl">{{ searchUrl || 'URL will appear here' }}</pre>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <ion-button
        expand="block"
        color="primary"
        (click)="openInLinkedIn()"
        [disabled]="!searchUrl">
        <ion-icon [name]="platformIcon" slot="start"></ion-icon>
        Open in {{ platformLabel }}
      </ion-button>

      <ion-button
        expand="block"
        fill="outline"
        color="medium"
        (click)="copyQuery()"
        [disabled]="!booleanQuery">
        <ion-icon name="copy" slot="start"></ion-icon>
        Copy Query
      </ion-button>

      <ion-button
        expand="block"
        fill="outline"
        color="medium"
        (click)="copyUrl()"
        [disabled]="!searchUrl">
        <ion-icon name="copy" slot="start"></ion-icon>
        Copy URL
      </ion-button>

      <ion-button
        expand="block"
        fill="outline"
        color="tertiary"
        (click)="shareSearch.emit()"
        [disabled]="!booleanQuery">
        <ion-icon name="share-social-outline" slot="start"></ion-icon>
        Share Search
      </ion-button>
    </div>
  </ion-card-content>
</ion-card>
